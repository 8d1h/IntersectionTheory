<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Development notes · IntersectionTheory.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">IntersectionTheory.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">About</a></li><li><span class="tocitem">Documentation</span><ul><li><a class="tocitem" href="../intro/">Introduction</a></li><li><a class="tocitem" href="../constructors/">Constructors</a></li><li><a class="tocitem" href="../varieties/">Varieties</a></li><li><a class="tocitem" href="../homog_varieties/">Homogeneous varieties</a></li><li><a class="tocitem" href="../bundles/">Bundles</a></li><li><a class="tocitem" href="../morphisms/">Morphisms</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../cubic_fourfold/">Special cubic fourfolds</a></li><li><a class="tocitem" href="../curves_on_quintic/">Rational curves on a quintic threefold</a></li></ul></li><li class="is-active"><a class="tocitem" href>Development notes</a><ul class="internal"><li><a class="tocitem" href="#Comparisons-with-other-packages"><span>Comparisons with other packages</span></a></li><li><a class="tocitem" href="#Benchmarks"><span>Benchmarks</span></a></li><li><a class="tocitem" href="#Some-notes"><span>Some notes</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Development notes</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Development notes</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/8d1h/IntersectionTheory/blob/master/docs/src/dev.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Development-notes"><a class="docs-heading-anchor" href="#Development-notes">Development notes</a><a id="Development-notes-1"></a><a class="docs-heading-anchor-permalink" href="#Development-notes" title="Permalink"></a></h1><h2 id="Comparisons-with-other-packages"><a class="docs-heading-anchor" href="#Comparisons-with-other-packages">Comparisons with other packages</a><a id="Comparisons-with-other-packages-1"></a><a class="docs-heading-anchor-permalink" href="#Comparisons-with-other-packages" title="Permalink"></a></h2><p>This package is largely a translation of existing functionalities from <em>Schubert2</em>, <em>Chow</em>, and <em>Schubert3</em> into Julia. Since most of the functionalities are already available elsewhere, the improvement in performance is important to justify its existence.</p><h3 id="*Schubert2*"><a class="docs-heading-anchor" href="#*Schubert2*"><em>Schubert2</em></a><a id="*Schubert2*-1"></a><a class="docs-heading-anchor-permalink" href="#*Schubert2*" title="Permalink"></a></h3><p>For <em>Schubert2</em>, we have already covered most of the functionalities, with the following exceptions:</p><ul><li>Isotropic flag bundles;</li><li><code>Correspondence</code> and <code>IncidenceCorrespondence</code> (what are the use cases for these?);</li><li>Better support for Schubert classes.</li><li></li></ul><p>Polynomial arithmetics in <em>Macaulay2</em> are quite slow compared to <em>Nemo</em> and <em>Singular</em>. So most computations will automatically run a lot faster in this package than <em>Schubert2</em>.</p><h3 id="*Chow*"><a class="docs-heading-anchor" href="#*Chow*"><em>Chow</em></a><a id="*Chow*-1"></a><a class="docs-heading-anchor-permalink" href="#*Chow*" title="Permalink"></a></h3><p>For <em>Chow</em>, (almost?) all functionalities are covered, notably the construction of parameter spaces for twisted cubics, which is one of its key features. Moreover, we implemented constructors for moduli spaces of matrices with arbitrary size.</p><p>Most computations in this package should run faster with a constant factor of 2 to 5 when compared to <em>Chow</em>, thanks to the high efficiency of the Julia/Oscar combo. Note that the blowup procedure in <em>Chow</em> is particularly inefficient. See below for comparisons.</p><h3 id="*Schubert3*"><a class="docs-heading-anchor" href="#*Schubert3*"><em>Schubert3</em></a><a id="*Schubert3*-1"></a><a class="docs-heading-anchor-permalink" href="#*Schubert3*" title="Permalink"></a></h3><p>For <em>Schubert3</em>, we implemented the functionality of computing integrals using Bott&#39;s formula on Grassmannians, and on flag varieties in general. Moduli spaces of maps (Kontsevich&#39;s spaces) are not implemented yet.</p><p>Again, most computations in this package should run faster with a constant factor.</p><h3 id="Others"><a class="docs-heading-anchor" href="#Others">Others</a><a id="Others-1"></a><a class="docs-heading-anchor-permalink" href="#Others" title="Permalink"></a></h3><p>A large part of the <em>Singular</em> library <em>chern.lib</em> is also covered.</p><h2 id="Benchmarks"><a class="docs-heading-anchor" href="#Benchmarks">Benchmarks</a><a id="Benchmarks-1"></a><a class="docs-heading-anchor-permalink" href="#Benchmarks" title="Permalink"></a></h2><p>All the timings are done on an Intel(R) Core(TM) i5-8350U CPU @ 1.70GHz.</p><h3 id="Computing-Todd-class"><a class="docs-heading-anchor" href="#Computing-Todd-class">Computing Todd class</a><a id="Computing-Todd-class-1"></a><a class="docs-heading-anchor-permalink" href="#Computing-Todd-class" title="Permalink"></a></h3><pre><code class="language-julia-repl">julia&gt; @time todd(proj(200));
  0.353537 seconds (989.07 k allocations: 44.766 MiB, 4.73% gc time)</code></pre><p><em>Chow</em>:</p><pre><code class="language-none">sage: time t = Proj(200).tangent_bundle().todd_class();
CPU times: user 1.23 s, sys: 715 µs, total: 1.23 s
Wall time: 1.19 s</code></pre><p><em>Schubert3</em>:</p><pre><code class="language-none">sage: time t = ProjectiveSpace(200).tangent_bundle().todd_class();
CPU times: user 2.15 s, sys: 1.15 ms, total: 2.15 s
Wall time: 2.15 s</code></pre><p><em>Schubert2</em> and <em>chern.lib</em> are far slower so are not included.</p><h3 id="Computing-blowup"><a class="docs-heading-anchor" href="#Computing-blowup">Computing blowup</a><a id="Computing-blowup-1"></a><a class="docs-heading-anchor-permalink" href="#Computing-blowup" title="Permalink"></a></h3><p>The computation of the blowup requires a &quot;pushforward&quot; function. In <em>Macaulay2</em> there are two functions that do this: <code>pushForward</code>, and <code>pushFwd</code> from the <em>PushForward</em> package. <code>pushFwd</code> eventually calls <code>pushForward</code> so they are in fact the same.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>Our implementation is still not optimal and is slower than <em>Macaulay2</em>&#39;s: the step using <code>std</code> to reduce the module is slow. Is this a Singular problem?</p></div></div><p>On the other hand, the counterpart in <em>Chow</em>, <code>FiniteRingExtension</code>, is very inefficient. This makes blowups in <em>Chow</em> very slow.</p><p>We compute the blowup of <span>$\mathbf P^{20}$</span> at a point.</p><pre><code class="language-julia-repl">julia&gt; @time blowup(point() → proj(20))[1] |&gt; euler
  0.011019 seconds (60.98 k allocations: 1.391 MiB)
40</code></pre><p><em>Schubert2</em>:</p><pre><code class="language-none">i12 : p = abstractProjectiveSpace 0; time euler first blowup map(abstractProjectiveSpace 20, p, OO_p)
     -- used 1.09486 seconds

o13 = 40</code></pre><p><em>Chow</em>:</p><pre><code class="language-none">sage: time Blowup(PointChowScheme.hom(&quot;0&quot;, Proj(20))).codomain().euler_number()
CPU times: user 16.7 s, sys: 6.9 ms, total: 16.7 s
Wall time: 16.8 s
40</code></pre><p><em>Schubert3</em> does not seem to provide this functionality.</p><p>Since the computations related to parameter spaces of twisted cubics use blowup, they run significantly faster in this package than with <em>Chow</em>.</p><ul><li>Compute the number of twisted cubics on a quintic threefold <code>twisted_cubics_on_quintic_threefold</code>: 5s v.s. 1min;</li><li>Compute the Euler number of the LLSvS eightfold <code>twisted_cubics_on_cubic_fourfold</code>: 2min v.s. 20min.</li></ul><h3 id="Linear-subspaces-on-hypersurfaces"><a class="docs-heading-anchor" href="#Linear-subspaces-on-hypersurfaces">Linear subspaces on hypersurfaces</a><a id="Linear-subspaces-on-hypersurfaces-1"></a><a class="docs-heading-anchor-permalink" href="#Linear-subspaces-on-hypersurfaces" title="Permalink"></a></h3><h4 id="Using-Schubert-calculus"><a class="docs-heading-anchor" href="#Using-Schubert-calculus">Using Schubert calculus</a><a id="Using-Schubert-calculus-1"></a><a class="docs-heading-anchor-permalink" href="#Using-Schubert-calculus" title="Permalink"></a></h4><pre><code class="language-julia-repl">julia&gt; @time IntersectionTheory.linear_subspaces_on_hypersurface(1, 35, bott=false)
  0.257564 seconds (1.66 M allocations: 30.382 MiB)
513687287764790207960329434065844597978401438841796875

julia&gt; @time IntersectionTheory.linear_subspaces_on_hypersurface(2, 7, bott=false)
  0.430082 seconds (2.68 M allocations: 42.083 MiB, 1.66% gc time)
279101475496912988004267637</code></pre><p><em>Schubert2</em>:</p><pre><code class="language-none">i4 : time integral chern symmetricPower_35 dual first bundles flagBundle{2,18}
     -- used 15.2021 seconds

o4 = 513687287764790207960329434065844597978401438841796875

i5 : time integral chern symmetricPower_7 dual first bundles flagBundle{3,12}
     -- used 12.3326 seconds

o5 = 279101475496912988004267637</code></pre><p><em>Chow</em>:</p><pre><code class="language-none">sage: time Grass(2,20).sheaves[&#39;universal_sub&#39;].dual().symm(35).chern_classes()[-1].integral()
CPU times: user 787 ms, sys: 12.6 ms, total: 800 ms
Wall time: 812 ms
513687287764790207960329434065844597978401438841796875

sage: time Grass(3,15).sheaves[&#39;universal_sub&#39;].dual().symm(7).chern_classes()[-1].integral()
CPU times: user 1.99 s, sys: 19.4 ms, total: 2.01 s
Wall time: 2.02 s
279101475496912988004267637</code></pre><p><em>Schubert3</em> is much slower and is not included.</p><h4 id="Using-Bott&#39;s-formula"><a class="docs-heading-anchor" href="#Using-Bott&#39;s-formula">Using Bott&#39;s formula</a><a id="Using-Bott&#39;s-formula-1"></a><a class="docs-heading-anchor-permalink" href="#Using-Bott&#39;s-formula" title="Permalink"></a></h4><pre><code class="language-julia-repl">julia&gt; @time IntersectionTheory.linear_subspaces_on_hypersurface(1, 57)
  0.263851 seconds (2.17 M allocations: 70.302 MiB, 36.51% gc time)
4543008461967180205447462399408892034555800983810817102531043233080341547902307166123135185210701405

julia&gt; @time IntersectionTheory.linear_subspaces_on_hypersurface(3, 5)
  0.546194 seconds (4.84 M allocations: 236.776 MiB, 31.41% gc time)
64127725294951805931404297113125</code></pre><p><em>Schubert3</em> is slightly a bit faster when <span>$k=1$</span>, but slower with bigger <span>$k$</span>.</p><pre><code class="language-none">sage: time linear_subspaces_hypersurface(1,57,30)
CPU times: user 260 ms, sys: 0 ns, total: 260 ms
Wall time: 260 ms
4543008461967180205447462399408892034555800983810817102531043233080341547902307166123135185210701405

sage: time linear_subspaces_hypersurface(3,5,17)
CPU times: user 2.15 s, sys: 0 ns, total: 2.15 s
Wall time: 2.15 s
64127725294951805931404297113125</code></pre><h2 id="Some-notes"><a class="docs-heading-anchor" href="#Some-notes">Some notes</a><a id="Some-notes-1"></a><a class="docs-heading-anchor-permalink" href="#Some-notes" title="Permalink"></a></h2><h3 id="Quotient-rings"><a class="docs-heading-anchor" href="#Quotient-rings">Quotient rings</a><a id="Quotient-rings-1"></a><a class="docs-heading-anchor-permalink" href="#Quotient-rings" title="Permalink"></a></h3><p>In a quotient ring, when should we do the reductions? It is obviously very costly to do this frequently; on the other hand, if we don&#39;t do it at all, we may accumulate some super complicated elements that will take a long time to reduce in the end. I find a good balance point is to do reduction for multiplications and powers, but not for additions and substractions. Here are some timings for a comparison. The bottleneck is when computing the Chern characters for the tautological subbundles using their Chern classes.</p><p>Current solution (reduction for <code>*</code> and <code>^</code> only)</p><pre><code class="language-julia-repl">julia&gt; @time flag(3,6,9);
  0.045371 seconds (489.13 k allocations: 6.366 MiB)</code></pre><p>Reduction for all the operators</p><pre><code class="language-julia-repl">julia&gt; @time flag(3,6,9);
  0.161490 seconds (769.00 k allocations: 8.604 MiB)</code></pre><p>No reduction at all</p><pre><code class="language-julia-repl">julia&gt; @time flag(3,6,9);
  1.168490 seconds (8.57 M allocations: 124.392 MiB, 1.07% gc time)</code></pre><p>(Although this necessarily means that the ideal should be in a standard basis.)</p><h3 id="Notes-on-Chow-rings"><a class="docs-heading-anchor" href="#Notes-on-Chow-rings">Notes on Chow rings</a><a id="Notes-on-Chow-rings-1"></a><a class="docs-heading-anchor-permalink" href="#Notes-on-Chow-rings" title="Permalink"></a></h3><ul><li><p>For a given <code>AbsVariety</code>, the underlying Singular ring of the Chow ring should <em>never</em> be modified: otherwise bundles already constructed will no longer be compatible. So whenever a new Singular ring is used, a new instance of <code>AbsVariety</code> should be created (e.g. <code>_inclusion</code>).</p></li><li><p>On the other hand, the ideal could be changed but one should be careful. In particular, since <code>basis_by_degree</code> is cached (this is necessary due to performance reasons, since we need to check the number of zero cycles when doing integration), changing the ideal may lead to issues. But <code>trim!</code> is an exception since it does not change the structure and is in fact needed before performing <code>basis_by_degree</code> (otherwise the ideal might not be 0-dimensional and we won&#39;t be able to use <code>kbase</code>).</p></li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../curves_on_quintic/">« Rational curves on a quintic threefold</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 28 May 2021 22:44">Friday 28 May 2021</span>. Using Julia version 1.6.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
